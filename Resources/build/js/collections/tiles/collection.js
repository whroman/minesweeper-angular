angular.module("CollectTiles",["ModelTile","angularLocalStorage"]).factory("CollectTiles",function(storage,ModelTile){var CollectTiles;return CollectTiles=function(){function CollectTiles(widthOrSavedGame,height,numOfMines){Array.isArray(widthOrSavedGame)?this.loadGame(widthOrSavedGame):this.newGame(widthOrSavedGame,height,numOfMines)}return CollectTiles.prototype.get=function(attrs){return this.getAll(attrs)[0]},CollectTiles.prototype.getAll=function(attrs){var key,matches,numOfAttrs,numOfMatchedAttrs,tile,val,_i,_j,_len,_len1,_ref,_ref1;if(matches=[],void 0===attrs)for(_ref=this.all,_i=0,_len=_ref.length;_len>_i;_i++)tile=_ref[_i],matches.push(tile);else for(_ref1=this.all,_j=0,_len1=_ref1.length;_len1>_j;_j++){tile=_ref1[_j],numOfAttrs=0,numOfMatchedAttrs=0;for(key in attrs)val=attrs[key],numOfAttrs++,tile.model[key]===val&&numOfMatchedAttrs++;numOfMatchedAttrs===numOfAttrs&&matches.push(tile)}return matches},CollectTiles.prototype.tallyMines=function(){var adjacentTile,neighborAttrs,neighborMine,neighborMines,neighborX,neighborY,tile,_i,_j,_len,_len1,_ref,_ref1;for(_ref=this.getAll(),_i=0,_len=_ref.length;_len>_i;_i++){for(tile=_ref[_i],neighborMines=0,_ref1=tile.adjacentTiles,_j=0,_len1=_ref1.length;_len1>_j;_j++)adjacentTile=_ref1[_j],neighborX=tile.model.x+adjacentTile[0],neighborY=tile.model.y+adjacentTile[1],neighborAttrs={isMine:!0,x:neighborX,y:neighborY},neighborMine=this.get(neighborAttrs),void 0!==neighborMine&&neighborMines++;tile.model.adjacentMines=neighborMines}return this},CollectTiles.prototype.randomSafeTile=function(){var findAttrs,randomIndex,safeTiles;return findAttrs={isClear:!1,isMine:!1},safeTiles=this.getAll(findAttrs),randomIndex=Math.floor(Math.random()*safeTiles.length),safeTiles[randomIndex]},CollectTiles.prototype.autoSelect=function(num){for(;num--;)this.randomSafeTile().clear();return this.all},CollectTiles.prototype.newGame=function(sizeX,sizeY,numOfMines){var attrs,mineNum,tile,x,y,_i,_j,_k,_ref,_ref1;for(this.reset(),y=_i=0,_ref=sizeY-1;_ref>=0?_ref>=_i:_i>=_ref;y=_ref>=0?++_i:--_i)for(x=_j=0,_ref1=sizeX-1;_ref1>=0?_ref1>=_j:_j>=_ref1;x=_ref1>=0?++_j:--_j)attrs={x:x,y:y},this.add(attrs);for(mineNum=_k=1;numOfMines>=1?numOfMines>=_k:_k>=numOfMines;mineNum=numOfMines>=1?++_k:--_k)tile=this.randomSafeTile(),tile.model.isMine=!0;return this.tallyMines()},CollectTiles.prototype.loadGame=function(savedTiles){var foo,tile,_i,_len;for(this.reset(),_i=0,_len=savedTiles.length;_len>_i;_i++)tile=savedTiles[_i],foo=this.add(tile.model),console.log(foo);return this},CollectTiles.prototype.reset=function(){return this.all=[],this},CollectTiles.prototype.add=function(model){var tile;return tile=new ModelTile(model),this.all.push(tile),tile},CollectTiles.prototype.clearNeighbors=function(tile){var adjacentTile,neighbor,shouldClearNeighbor,shouldClearNeighbors,_i,_len,_ref;if(shouldClearNeighbors=0===tile.model.adjacentMines&&tile.model.isMine===!1)for(_ref=tile.adjacentTiles,_i=0,_len=_ref.length;_len>_i;_i++)adjacentTile=_ref[_i],neighbor=this.get({x:tile.model.x+adjacentTile[0],y:tile.model.y+adjacentTile[1]}),shouldClearNeighbor=neighbor&&neighbor.model.isClear===!1&&neighbor.model.isMine===!1,shouldClearNeighbor&&neighbor.clear();return this},CollectTiles}()});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbGxlY3Rpb25zL3RpbGVzL2NvbGxlY3Rpb24uY29mZmVlIiwiY29sbGVjdGlvbnMvdGlsZXMvY29sbGVjdGlvbi5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiZmFjdG9yeSIsInN0b3JhZ2UiLCJNb2RlbFRpbGUiLCJDb2xsZWN0VGlsZXMiLCJ3aWR0aE9yU2F2ZWRHYW1lIiwiaGVpZ2h0IiwibnVtT2ZNaW5lcyIsIkFycmF5IiwiaXNBcnJheSIsInRoaXMiLCJsb2FkR2FtZSIsIm5ld0dhbWUiLCJwcm90b3R5cGUiLCJnZXQiLCJhdHRycyIsImdldEFsbCIsImtleSIsIm1hdGNoZXMiLCJudW1PZkF0dHJzIiwibnVtT2ZNYXRjaGVkQXR0cnMiLCJ0aWxlIiwidmFsIiwiX2kiLCJfaiIsIl9sZW4iLCJfbGVuMSIsIl9yZWYiLCJfcmVmMSIsImFsbCIsImxlbmd0aCIsInB1c2giLCJtb2RlbCIsInRhbGx5TWluZXMiLCJhZGphY2VudFRpbGUiLCJuZWlnaGJvckF0dHJzIiwibmVpZ2hib3JNaW5lIiwibmVpZ2hib3JNaW5lcyIsIm5laWdoYm9yWCIsIm5laWdoYm9yWSIsImFkamFjZW50VGlsZXMiLCJ4IiwieSIsImlzTWluZSIsImFkamFjZW50TWluZXMiLCJyYW5kb21TYWZlVGlsZSIsImZpbmRBdHRycyIsInJhbmRvbUluZGV4Iiwic2FmZVRpbGVzIiwiaXNDbGVhciIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImF1dG9TZWxlY3QiLCJudW0iLCJjbGVhciIsInNpemVYIiwic2l6ZVkiLCJtaW5lTnVtIiwiX2siLCJyZXNldCIsImFkZCIsInNhdmVkVGlsZXMiLCJmb28iLCJjb25zb2xlIiwibG9nIiwiY2xlYXJOZWlnaGJvcnMiLCJuZWlnaGJvciIsInNob3VsZENsZWFyTmVpZ2hib3IiLCJzaG91bGRDbGVhck5laWdoYm9ycyJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQ0NDLE9BQU8sZ0JBRUosWUFDQSx3QkFHSEMsUUFBUSxlQUFn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SXJCLEtBQUtXLE1BQU1VLEVBQUlSLGFBQWEsS0FHcENrQyxvQkFDSUQsVUFDQUEsU0FBU25DLE1BQU1pQixXQUFXLEdBQzFCa0IsU0FBU25DLE1BQU1XLFVBQVUsRUFFMUJ5QixxQkFDQ0QsU0FBU1osT0M0QjNCLE9EMUJNN0MsT0M2QkROIiwiZmlsZSI6ImNvbGxlY3Rpb25zL3RpbGVzL2NvbGxlY3Rpb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyXG4ubW9kdWxlICdDb2xsZWN0VGlsZXMnLCBbXG4jIERlcGVuZGVuY2llc1xuICAgICdNb2RlbFRpbGUnLFxuICAgICdhbmd1bGFyTG9jYWxTdG9yYWdlJ1xuXVxuXG4uZmFjdG9yeSAnQ29sbGVjdFRpbGVzJywgKFxuICAgIHN0b3JhZ2UsXG4gICAgTW9kZWxUaWxlXG4pIC0+XG4gICAgY2xhc3MgQ29sbGVjdFRpbGVzXG4gICAgICAgIGNvbnN0cnVjdG9yIDogKHdpZHRoT3JTYXZlZEdhbWUsIGhlaWdodCwgbnVtT2ZNaW5lcykgLT5cbiAgICAgICAgICAgIGlmIEFycmF5LmlzQXJyYXkgd2lkdGhPclNhdmVkR2FtZVxuICAgICAgICAgICAgICAgIEBsb2FkR2FtZSB3aWR0aE9yU2F2ZWRHYW1lXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgQG5ld0dhbWUgd2lkdGhPclNhdmVkR2FtZSwgaGVpZ2h0LCBudW1PZk1pbmVzXG4gICAgICAgICAgICBAXG5cbiAgICAgICAgZ2V0IDogKGF0dHJzKSAtPlxuICAgICAgICAgICAgcmV0dXJuIEBnZXRBbGwoYXR0cnMpWzBdXG5cbiAgICAgICAgZ2V0QWxsIDogKGF0dHJzKSAtPlxuICAgICAgICAgICAgbWF0Y2hlcyA9IFtdXG4gICAgICAgICAgICBpZiBhdHRycyBpcyB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICBmb3IgdGlsZSBpbiBAYWxsXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZXMucHVzaCB0aWxlXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZm9yIHRpbGUgaW4gQGFsbFxuICAgICAgICAgICAgICAgICAgICBudW1PZkF0dHJzID0gMFxuICAgICAgICAgICAgICAgICAgICBudW1PZk1hdGNoZWRBdHRycyA9IDBcbiAgICAgICAgICAgICAgICAgICAgZm9yIGtleSwgdmFsIG9mIGF0dHJzXG4gICAgICAgICAgICAgICAgICAgICAgICBudW1PZkF0dHJzKytcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRpbGUubW9kZWxba2V5XSBpcyB2YWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1PZk1hdGNoZWRBdHRycysrXG5cbiAgICAgICAgICAgICAgICAgICAgaWYgbnVtT2ZNYXRjaGVkQXR0cnMgaXMgbnVtT2ZBdHRyc1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcy5wdXNoIHRpbGVcblxuICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXNcblxuICAgICAgICB0YWxseU1pbmVzIDogKCkgLT5cbiAgICAgICAgICAgIGZvciB0aWxlIGluIHRoaXMuZ2V0QWxsKClcbiAgICAgICAgICAgICAgICBuZWlnaGJvck1pbmVzID0gMFxuICAgICAgICAgICAgICAgIGZvciBhZGphY2VudFRpbGUgaW4gdGlsZS5hZGphY2VudFRpbGVzXG4gICAgICAgICAgICAgICAgICAgIG5laWdoYm9yWCA9IHRpbGUubW9kZWwueCArIGFkamFjZW50VGlsZVswXSBcbiAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3JZID0gdGlsZS5tb2RlbC55ICsgYWRqYWNlbnRUaWxlWzFdXG4gICAgICAgICAgICAgICAgICAgIG5laWdoYm9yQXR0cnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc01pbmUgIDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgeCAgICAgICA6IG5laWdoYm9yWFxuICAgICAgICAgICAgICAgICAgICAgICAgeSAgICAgICA6IG5laWdoYm9yWVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG5laWdoYm9yTWluZSA9IHRoaXMuZ2V0KG5laWdoYm9yQXR0cnMpXG4gICAgICAgICAgICAgICAgICAgIGlmIG5laWdoYm9yTWluZSBpc250IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3JNaW5lcysrXG4gICAgICAgICAgICAgICAgdGlsZS5tb2RlbC5hZGphY2VudE1pbmVzID0gbmVpZ2hib3JNaW5lc1xuXG4gICAgICAgICAgICBAXG5cbiAgICAgICAgcmFuZG9tU2FmZVRpbGUgOiAoKSAtPlxuICAgICAgICAgICAgZmluZEF0dHJzID1cbiAgICAgICAgICAgICAgICBpc0NsZWFyIDogZmFsc2VcbiAgICAgICAgICAgICAgICBpc01pbmUgIDogZmFsc2VcblxuICAgICAgICAgICAgc2FmZVRpbGVzID0gQGdldEFsbCBmaW5kQXR0cnNcbiAgICAgICAgICAgIHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vciBNYXRoLnJhbmRvbSgpICogc2FmZVRpbGVzLmxlbmd0aFxuICAgICAgICAgICAgcmV0dXJuIHNhZmVUaWxlc1sgcmFuZG9tSW5kZXggXVxuXG4gICAgICAgIGF1dG9TZWxlY3QgOiAobnVtKSAtPlxuICAgICAgICAgICAgd2hpbGUgbnVtLS1cbiAgICAgICAgICAgICAgICBAcmFuZG9tU2FmZVRpbGUoKS5jbGVhcigpXG5cbiAgICAgICAgICAgIEBhbGxcblxuICAgICAgICBuZXdHYW1lIDogKHNpemVYLCBzaXplWSwgbnVtT2ZNaW5lcykgLT5cbiAgICAgICAgICAgIEByZXNldCgpXG4gICAgICAgICAgICBmb3IgeSBpbiBbMC4uc2l6ZVkgLSAxXVxuICAgICAgICAgICAgICAgIGZvciB4IGluIFswLi5zaXplWCAtIDFdXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgeCAgIDogeFxuICAgICAgICAgICAgICAgICAgICAgICAgeSAgIDogeVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIEBhZGQgYXR0cnNcblxuICAgICAgICAgICAgZm9yIG1pbmVOdW0gaW4gWzEuLm51bU9mTWluZXNdXG4gICAgICAgICAgICAgICAgdGlsZSA9IEByYW5kb21TYWZlVGlsZSgpXG4gICAgICAgICAgICAgICAgdGlsZS5tb2RlbC5pc01pbmUgPSB0cnVlXG5cbiAgICAgICAgICAgIEB0YWxseU1pbmVzKClcblxuICAgICAgICBsb2FkR2FtZSA6IChzYXZlZFRpbGVzKSAtPlxuICAgICAgICAgICAgQHJlc2V0KClcbiAgICAgICAgICAgIGZvciB0aWxlIGluIHNhdmVkVGlsZXNcbiAgICAgICAgICAgICAgICBmb28gPSBAYWRkIHRpbGUubW9kZWxcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyBmb29cbiAgICAgICAgICAgIEBcblxuICAgICAgICByZXNldCA6IC0+XG4gICAgICAgICAgICBAYWxsID0gW11cbiAgICAgICAgICAgIEBcblxuICAgICAgICBhZGQgOiAobW9kZWwpIC0+XG4gICAgICAgICAgICB0aWxlID0gbmV3IE1vZGVsVGlsZSBtb2RlbFxuICAgICAgICAgICAgQGFsbC5wdXNoIHRpbGVcbiAgICAgICAgICAgIHRpbGVcblxuICAgICAgICBjbGVhck5laWdoYm9ycyA6ICh0aWxlKSAtPlxuICAgICAgICAgICAgc2hvdWxkQ2xlYXJOZWlnaGJvcnMgPSB0aWxlLm1vZGVsLmFkamFjZW50TWluZXMgaXMgMCBhbmQgdGlsZS5tb2RlbC5pc01pbmUgaXMgZmFsc2VcbiAgICAgICAgICAgIGlmIHNob3VsZENsZWFyTmVpZ2hib3JzXG4gICAgICAgICAgICAgICAgZm9yIGFkamFjZW50VGlsZSBpbiB0aWxlLmFkamFjZW50VGlsZXNcbiAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3IgPSBAZ2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgeCA6IHRpbGUubW9kZWwueCArIGFkamFjZW50VGlsZVswXVxuICAgICAgICAgICAgICAgICAgICAgICAgeSA6IHRpbGUubW9kZWwueSArIGFkamFjZW50VGlsZVsxXVxuICAgICAgICAgICAgICAgICAgICApXG5cbiAgICAgICAgICAgICAgICAgICAgc2hvdWxkQ2xlYXJOZWlnaGJvciA9IChcbiAgICAgICAgICAgICAgICAgICAgICAgIG5laWdoYm9yIGFuZFxuICAgICAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3IubW9kZWwuaXNDbGVhciBpcyBmYWxzZSBhbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5laWdoYm9yLm1vZGVsLmlzTWluZSBpcyBmYWxzZVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgIGlmIHNob3VsZENsZWFyTmVpZ2hib3JcbiAgICAgICAgICAgICAgICAgICAgICAgIG5laWdoYm9yLmNsZWFyKClcblxuICAgICAgICAgICAgQCIsbnVsbF0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9