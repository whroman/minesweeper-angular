var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("CollectTiles",["ModelTile"]).factory("CollectTiles",function(ModelTile){var CollectTiles;return CollectTiles=function(){function CollectTiles(widthOrSavedGame,height,numOfMines){var Model,collection;collection=this,this.model=Model=function(_super){function Model(){return Model.__super__.constructor.apply(this,arguments)}return __extends(Model,_super),Model.prototype.collection=collection,Model}(ModelTile),Array.isArray(widthOrSavedGame)?this.loadGame(widthOrSavedGame):this.newGame(widthOrSavedGame,height,numOfMines)}return CollectTiles.prototype.add=function(model){var tile;return tile=new this.model(model),this.all.push(tile),tile},CollectTiles.prototype.get=function(attrs){return this.getAll(attrs)[0]},CollectTiles.prototype.getAll=function(attrs){var key,matches,numOfAttrs,numOfMatchedAttrs,tile,val,_i,_j,_len,_len1,_ref,_ref1;if(matches=[],void 0===attrs)for(_ref=this.all,_i=0,_len=_ref.length;_len>_i;_i++)tile=_ref[_i],matches.push(tile);else for(_ref1=this.all,_j=0,_len1=_ref1.length;_len1>_j;_j++){tile=_ref1[_j],numOfAttrs=0,numOfMatchedAttrs=0;for(key in attrs)val=attrs[key],numOfAttrs++,tile.model[key]===val&&numOfMatchedAttrs++;numOfMatchedAttrs===numOfAttrs&&matches.push(tile)}return matches},CollectTiles.prototype.tallyMines=function(){var adjacentTile,neighborAttrs,neighborMine,neighborMines,neighborX,neighborY,tile,_i,_j,_len,_len1,_ref,_ref1;for(_ref=this.getAll(),_i=0,_len=_ref.length;_len>_i;_i++){for(tile=_ref[_i],neighborMines=0,_ref1=tile.adjacentTiles,_j=0,_len1=_ref1.length;_len1>_j;_j++)adjacentTile=_ref1[_j],neighborX=tile.model.x+adjacentTile[0],neighborY=tile.model.y+adjacentTile[1],neighborAttrs={isMine:!0,x:neighborX,y:neighborY},neighborMine=this.get(neighborAttrs),void 0!==neighborMine&&neighborMines++;tile.model.adjacentMines=neighborMines}return this},CollectTiles.prototype.randomSafeTile=function(){var findAttrs,randomIndex,safeTiles;return findAttrs={isClear:!1,isMine:!1},safeTiles=this.getAll(findAttrs),randomIndex=Math.floor(Math.random()*safeTiles.length),safeTiles[randomIndex]},CollectTiles.prototype.autoSelect=function(num){for(;num--;)this.randomSafeTile().clear();return this.all},CollectTiles.prototype.newGame=function(sizeX,sizeY,numOfMines){var attrs,mineNum,tile,x,y,_i,_j,_k,_ref,_ref1;for(this.reset(),y=_i=0,_ref=sizeY-1;_ref>=0?_ref>=_i:_i>=_ref;y=_ref>=0?++_i:--_i)for(x=_j=0,_ref1=sizeX-1;_ref1>=0?_ref1>=_j:_j>=_ref1;x=_ref1>=0?++_j:--_j)attrs={x:x,y:y},this.add(attrs);for(mineNum=_k=1;numOfMines>=1?numOfMines>=_k:_k>=numOfMines;mineNum=numOfMines>=1?++_k:--_k)tile=this.randomSafeTile(),tile.model.isMine=!0;return this.tallyMines()},CollectTiles.prototype.loadGame=function(savedTiles){var tile,_i,_len;for(this.reset(),_i=0,_len=savedTiles.length;_len>_i;_i++)tile=savedTiles[_i],this.add(tile.model);return this},CollectTiles.prototype.reset=function(){return this.all=[],this},CollectTiles.prototype.clearNeighbors=function(tile){var adjacentTile,neighbor,shouldClearNeighbor,shouldClearNeighbors,_i,_len,_ref;if(shouldClearNeighbors=0===tile.model.adjacentMines&&tile.model.isMine===!1)for(_ref=tile.adjacentTiles,_i=0,_len=_ref.length;_len>_i;_i++)adjacentTile=_ref[_i],neighbor=this.get({x:tile.model.x+adjacentTile[0],y:tile.model.y+adjacentTile[1]}),shouldClearNeighbor=neighbor&&neighbor.model.isClear===!1&&neighbor.model.isMine===!1,shouldClearNeighbor&&neighbor.clear();return this},CollectTiles}()});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbGxlY3Rpb25zL3RpbGVzLmNvZmZlZSIsImNvbGxlY3Rpb25zL3RpbGVzLmpzIl0sIm5hbWVzIjpbIl9faGFzUHJvcCIsImhhc093blByb3BlcnR5IiwiX19leHRlbmRzIiwiY2hpbGQiLCJwYXJlbnQiLCJjdG9yIiwidGhpcyIsImNvbnN0cnVjdG9yIiwia2V5IiwiY2FsbCIsInByb3RvdHlwZSIsIl9fc3VwZXJfXyIsImFuZ3VsYXIiLCJtb2R1bGUiLCJmYWN0b3J5IiwiTW9kZWxUaWxlIiwiQ29sbGVjdFRpbGVzIiwid2lkdGhPclNhdmVkR2FtZSIsImhlaWdodCIsIm51bU9mTWluZXMiLCJNb2RlbCIsImNvbGxlY3Rpb24iLCJtb2RlbCIsIl9zdXBlciIsImFwcGx5IiwiYXJndW1lbnRzIiwiQXJyYXkiLCJpc0FycmF5IiwibG9hZEdhbWUiLCJuZXdHYW1lIiwiYWRkIiwidGlsZSIsImFsbCIsInB1c2giLCJnZXQiLCJhdHRycyIsImdldEFsbCIsIm1hdGNoZXMiLCJudW1PZkF0dHJzIiwibnVtT2ZNYXRjaGVkQXR0cnMiLCJ2YWwiLCJfaSIsIl9qIiwiX2xlbiIsIl9sZW4xIiwiX3JlZiIsIl9yZWYxIiwibGVuZ3RoIiwidGFsbHlNaW5lcyIsImFkamFjZW50VGlsZSIsIm5laWdoYm9yQXR0cnMiLCJuZWlnaGJvck1pbmUiLCJuZWlnaGJvck1pbmVzIiwibmVpZ2hib3JYIiwibmVpZ2hib3JZIiwiYWRqYWNlbnRUaWxlcyIsIngiLCJ5IiwiaXNNaW5lIiwiYWRqYWNlbnRNaW5lcyIsInJhbmRvbVNhZmVUaWxlIiwiZmluZEF0dHJzIiwicmFuZG9tSW5kZXgiLCJzYWZlVGlsZXMiLCJpc0NsZWFyIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiYXV0b1NlbGVjdCIsIm51bSIsImNsZWFyIiwic2l6ZVgiLCJzaXplWSIsIm1pbmVOdW0iLCJfayIsInJlc2V0Iiwic2F2ZWRUaWxlcyIsImNsZWFyTmVpZ2hib3JzIiwibmVpZ2hib3IiLCJzaG91bGRD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QXJDLEtBQUNxRSxRQUNEbEMsR0FBQSxFQUFBRSxLQUFBaUMsV0FBQTdCLE9BQUFKLEtBQUFGLEdBQUFBLEtDa0NKVixLQUFPNkMsV0FBV25DLElEakNWbkMsS0FBQ3dCLElBQUlDLEtBQUtULE1Db0NwQixPRG5DTWhCLE9BL0ZKVSxhQUFBTixVQWlHQWlFLE1BQVEsV0NzQ1YsTURyQ01yRSxNQUFDMEIsT0FDRDFCLE1BbkdKVSxhQUFBTixVQXFHQW1FLGVBQWlCLFNBQUM5QyxNQUNkLEdBQUFrQixjQUFBNkIsU0FBQUMsb0JBQUFDLHFCQUFBdkMsR0FBQUUsS0FBQUUsSUFDQSxJQURBbUMscUJBQW1ELElBQTVCakQsS0FBS1QsTUFBTXFDLGVBQXVCNUIsS0FBS1QsTUFBTW9DLFVBQVUsRUFFMUUsSUFBQWIsS0FBQWQsS0FBQXdCLGNBQUFkLEdBQUEsRUFBQUUsS0FBQUUsS0FBQUUsT0FBQUosS0FBQUYsR0FBQUEsS0N3Q05RLGFBQWVKLEtBQUtKLElEdkNWcUMsU0FBV3hFLEtBQUM0QixLQUNSc0IsRUFBSXpCLEtBQUtULE1BQU1rQyxFQUFJUCxhQUFhLEdBQ2hDUSxFQUFJMUIsS0FBS1QsTUFBTW1DLEVBQUlSLGFBQWEsS0FHcEM4QixvQkFDSUQsVUFDQUEsU0FBU3hELE1BQU0wQyxXQUFXLEdBQzFCYyxTQUFTeEQsTUFBTW9DLFVBQVUsRUFHMUJxQixxQkFDQ0QsU0FBU1IsT0NzQzNCLE9EcENNaEUsT0N1Q0RVIiwiZmlsZSI6ImNvbGxlY3Rpb25zL3RpbGVzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhclxuLm1vZHVsZSAnQ29sbGVjdFRpbGVzJywgW1xuIyBEZXBlbmRlbmNpZXNcbiAgICAnTW9kZWxUaWxlJyxcbl1cblxuLmZhY3RvcnkgJ0NvbGxlY3RUaWxlcycsIChcbiAgICBNb2RlbFRpbGVcbikgLT5cbiAgICBjbGFzcyBDb2xsZWN0VGlsZXNcbiAgICAgICAgY29uc3RydWN0b3IgOiAod2lkdGhPclNhdmVkR2FtZSwgaGVpZ2h0LCBudW1PZk1pbmVzKSAtPlxuICAgICAgICAgICAgIyBCaW5kaW5nIENvbGxlY3Rpb24gdG8gTW9kZWwgc28gdGhhdCBpbnN0YW5jZXMgb2YgTW9kZWwgY2FuIGNhbGwgQ29sbGVjdGlvbiBtZXRob2RzXG4gICAgICAgICAgICBjb2xsZWN0aW9uID0gQFxuICAgICAgICAgICAgQG1vZGVsID0gY2xhc3MgTW9kZWwgZXh0ZW5kcyBNb2RlbFRpbGVcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uOiBjb2xsZWN0aW9uXG5cbiAgICAgICAgICAgICMgTG9hZCBvciBDcmVhdGUgbmV3IGdhbWVcbiAgICAgICAgICAgIGlmIEFycmF5LmlzQXJyYXkgd2lkdGhPclNhdmVkR2FtZVxuICAgICAgICAgICAgICAgIEBsb2FkR2FtZSB3aWR0aE9yU2F2ZWRHYW1lXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgQG5ld0dhbWUgd2lkdGhPclNhdmVkR2FtZSwgaGVpZ2h0LCBudW1PZk1pbmVzXG4gICAgICAgICAgICBAXG5cbiAgICAgICAgIyBCaW5kIENvbGxlY3Rpb24gbWV0aG9kcyB0aGF0IHRha2UgYHRpbGVgIGFzIGlucHV0IHRvIHJlcXVpcmUgbm8gYXJnIGlmIGNhbGxlZCBieVxuICAgICAgICAjIGB0aWxlLmNvbGxlY3Rpb25bbWV0aG9kTmFtZV1gXG4gICAgICAgIGFkZCA6IChtb2RlbCkgLT5cbiAgICAgICAgICAgIHRpbGUgPSBuZXcgQG1vZGVsIG1vZGVsXG4gICAgICAgICAgICBAYWxsLnB1c2ggdGlsZVxuICAgICAgICAgICAgdGlsZVxuXG4gICAgICAgIGdldCA6IChhdHRycykgLT5cbiAgICAgICAgICAgIHJldHVybiBAZ2V0QWxsKGF0dHJzKVswXVxuXG4gICAgICAgIGdldEFsbCA6IChhdHRycykgLT5cbiAgICAgICAgICAgIG1hdGNoZXMgPSBbXVxuICAgICAgICAgICAgaWYgYXR0cnMgaXMgdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgZm9yIHRpbGUgaW4gQGFsbFxuICAgICAgICAgICAgICAgICAgICBtYXRjaGVzLnB1c2ggdGlsZVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGZvciB0aWxlIGluIEBhbGxcbiAgICAgICAgICAgICAgICAgICAgbnVtT2ZBdHRycyA9IDBcbiAgICAgICAgICAgICAgICAgICAgbnVtT2ZNYXRjaGVkQXR0cnMgPSAwXG4gICAgICAgICAgICAgICAgICAgIGZvciBrZXksIHZhbCBvZiBhdHRyc1xuICAgICAgICAgICAgICAgICAgICAgICAgbnVtT2ZBdHRycysrXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiB0aWxlLm1vZGVsW2tleV0gaXMgdmFsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtT2ZNYXRjaGVkQXR0cnMrK1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIG51bU9mTWF0Y2hlZEF0dHJzIGlzIG51bU9mQXR0cnNcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXMucHVzaCB0aWxlXG5cbiAgICAgICAgICAgIHJldHVybiBtYXRjaGVzXG5cbiAgICAgICAgdGFsbHlNaW5lcyA6ICgpIC0+XG4gICAgICAgICAgICBmb3IgdGlsZSBpbiBAZ2V0QWxsKClcbiAgICAgICAgICAgICAgICBuZWlnaGJvck1pbmVzID0gMFxuICAgICAgICAgICAgICAgIGZvciBhZGphY2VudFRpbGUgaW4gdGlsZS5hZGphY2VudFRpbGVzXG4gICAgICAgICAgICAgICAgICAgIG5laWdoYm9yWCA9IHRpbGUubW9kZWwueCArIGFkamFjZW50VGlsZVswXSBcbiAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3JZID0gdGlsZS5tb2RlbC55ICsgYWRqYWNlbnRUaWxlWzFdXG4gICAgICAgICAgICAgICAgICAgIG5laWdoYm9yQXR0cnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc01pbmUgIDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgeCAgICAgICA6IG5laWdoYm9yWFxuICAgICAgICAgICAgICAgICAgICAgICAgeSAgICAgICA6IG5laWdoYm9yWVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG5laWdoYm9yTWluZSA9IHRoaXMuZ2V0KG5laWdoYm9yQXR0cnMpXG4gICAgICAgICAgICAgICAgICAgIGlmIG5laWdoYm9yTWluZSBpc250IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3JNaW5lcysrXG4gICAgICAgICAgICAgICAgdGlsZS5tb2RlbC5hZGphY2VudE1pbmVzID0gbmVpZ2hib3JNaW5lc1xuXG4gICAgICAgICAgICBAXG5cbiAgICAgICAgcmFuZG9tU2FmZVRpbGUgOiAoKSAtPlxuICAgICAgICAgICAgZmluZEF0dHJzID1cbiAgICAgICAgICAgICAgICBpc0NsZWFyIDogZmFsc2VcbiAgICAgICAgICAgICAgICBpc01pbmUgIDogZmFsc2VcblxuICAgICAgICAgICAgc2FmZVRpbGVzID0gQGdldEFsbCBmaW5kQXR0cnNcbiAgICAgICAgICAgIHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vciBNYXRoLnJhbmRvbSgpICogc2FmZVRpbGVzLmxlbmd0aFxuICAgICAgICAgICAgcmV0dXJuIHNhZmVUaWxlc1sgcmFuZG9tSW5kZXggXVxuXG4gICAgICAgIGF1dG9TZWxlY3QgOiAobnVtKSAtPlxuICAgICAgICAgICAgd2hpbGUgbnVtLS1cbiAgICAgICAgICAgICAgICBAcmFuZG9tU2FmZVRpbGUoKS5jbGVhcigpXG5cbiAgICAgICAgICAgIEBhbGxcblxuICAgICAgICBuZXdHYW1lIDogKHNpemVYLCBzaXplWSwgbnVtT2ZNaW5lcykgLT5cbiAgICAgICAgICAgIEByZXNldCgpXG4gICAgICAgICAgICBmb3IgeSBpbiBbMC4uc2l6ZVkgLSAxXVxuICAgICAgICAgICAgICAgIGZvciB4IGluIFswLi5zaXplWCAtIDFdXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgeCAgIDogeFxuICAgICAgICAgICAgICAgICAgICAgICAgeSAgIDogeVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIEBhZGQgYXR0cnNcblxuICAgICAgICAgICAgZm9yIG1pbmVOdW0gaW4gWzEuLm51bU9mTWluZXNdXG4gICAgICAgICAgICAgICAgdGlsZSA9IEByYW5kb21TYWZlVGlsZSgpXG4gICAgICAgICAgICAgICAgdGlsZS5tb2RlbC5pc01pbmUgPSB0cnVlXG5cbiAgICAgICAgICAgIEB0YWxseU1pbmVzKClcblxuICAgICAgICBsb2FkR2FtZSA6IChzYXZlZFRpbGVzKSAtPlxuICAgICAgICAgICAgQHJlc2V0KClcbiAgICAgICAgICAgIGZvciB0aWxlIGluIHNhdmVkVGlsZXNcbiAgICAgICAgICAgICAgICBAYWRkIHRpbGUubW9kZWxcbiAgICAgICAgICAgIEBcblxuICAgICAgICByZXNldCA6IC0+XG4gICAgICAgICAgICBAYWxsID0gW11cbiAgICAgICAgICAgIEBcblxuICAgICAgICBjbGVhck5laWdoYm9ycyA6ICh0aWxlKSAtPlxuICAgICAgICAgICAgc2hvdWxkQ2xlYXJOZWlnaGJvcnMgPSB0aWxlLm1vZGVsLmFkamFjZW50TWluZXMgaXMgMCBhbmQgdGlsZS5tb2RlbC5pc01pbmUgaXMgZmFsc2VcbiAgICAgICAgICAgIGlmIHNob3VsZENsZWFyTmVpZ2hib3JzXG4gICAgICAgICAgICAgICAgZm9yIGFkamFjZW50VGlsZSBpbiB0aWxlLmFkamFjZW50VGlsZXNcbiAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3IgPSBAZ2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgeCA6IHRpbGUubW9kZWwueCArIGFkamFjZW50VGlsZVswXVxuICAgICAgICAgICAgICAgICAgICAgICAgeSA6IHRpbGUubW9kZWwueSArIGFkamFjZW50VGlsZVsxXVxuICAgICAgICAgICAgICAgICAgICApXG5cbiAgICAgICAgICAgICAgICAgICAgc2hvdWxkQ2xlYXJOZWlnaGJvciA9IChcbiAgICAgICAgICAgICAgICAgICAgICAgIG5laWdoYm9yIGFuZFxuICAgICAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3IubW9kZWwuaXNDbGVhciBpcyBmYWxzZSBhbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5laWdoYm9yLm1vZGVsLmlzTWluZSBpcyBmYWxzZVxuICAgICAgICAgICAgICAgICAgICApXG5cbiAgICAgICAgICAgICAgICAgICAgaWYgc2hvdWxkQ2xlYXJOZWlnaGJvclxuICAgICAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3IuY2xlYXIoKVxuXG4gICAgICAgICAgICBAIixudWxsXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=