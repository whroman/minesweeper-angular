var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("CollectTiles",["ModelTile"]).factory("CollectTiles",function(ModelTile){var CollectTiles;return CollectTiles=function(){function CollectTiles(widthOrSavedGame,height,numOfMines){var Model,collection;collection=this,this.model=Model=function(_super){function Model(){return Model.__super__.constructor.apply(this,arguments)}return __extends(Model,_super),Model.prototype.clear=function(){return Model.__super__.clear.call(this),collection.clearNeighbors(this)},Model}(ModelTile),Array.isArray(widthOrSavedGame)?this.loadGame(widthOrSavedGame):this.newGame(widthOrSavedGame,height,numOfMines)}return CollectTiles.prototype.add=function(model){var tile;return tile=new this.model(model),this.all.push(tile),tile},CollectTiles.prototype.get=function(attrs){return this.getAll(attrs)[0]},CollectTiles.prototype.getAll=function(attrs){var key,matches,numOfAttrs,numOfMatchedAttrs,tile,val,_i,_j,_len,_len1,_ref,_ref1;if(matches=[],void 0===attrs)for(_ref=this.all,_i=0,_len=_ref.length;_len>_i;_i++)tile=_ref[_i],matches.push(tile);else for(_ref1=this.all,_j=0,_len1=_ref1.length;_len1>_j;_j++){tile=_ref1[_j],numOfAttrs=0,numOfMatchedAttrs=0;for(key in attrs)val=attrs[key],numOfAttrs++,tile.model[key]===val&&numOfMatchedAttrs++;numOfMatchedAttrs===numOfAttrs&&matches.push(tile)}return matches},CollectTiles.prototype.tallyMines=function(){var adjacentTile,neighborAttrs,neighborMine,neighborMines,neighborX,neighborY,tile,_i,_j,_len,_len1,_ref,_ref1;for(_ref=this.getAll(),_i=0,_len=_ref.length;_len>_i;_i++){for(tile=_ref[_i],neighborMines=0,_ref1=tile.adjacentTiles,_j=0,_len1=_ref1.length;_len1>_j;_j++)adjacentTile=_ref1[_j],neighborX=tile.model.x+adjacentTile[0],neighborY=tile.model.y+adjacentTile[1],neighborAttrs={isMine:!0,x:neighborX,y:neighborY},neighborMine=this.get(neighborAttrs),void 0!==neighborMine&&neighborMines++;tile.model.adjacentMines=neighborMines}return this},CollectTiles.prototype.randomSafeTile=function(){var findAttrs,randomIndex,safeTiles;return findAttrs={isClear:!1,isMine:!1},safeTiles=this.getAll(findAttrs),randomIndex=Math.floor(Math.random()*safeTiles.length),safeTiles[randomIndex]},CollectTiles.prototype.autoSelect=function(num){for(;num--;)this.randomSafeTile().clear();return this.all},CollectTiles.prototype.newGame=function(sizeX,sizeY,numOfMines){var attrs,mineNum,tile,x,y,_i,_j,_k,_ref,_ref1;for(this.reset(),y=_i=0,_ref=sizeY-1;_ref>=0?_ref>=_i:_i>=_ref;y=_ref>=0?++_i:--_i)for(x=_j=0,_ref1=sizeX-1;_ref1>=0?_ref1>=_j:_j>=_ref1;x=_ref1>=0?++_j:--_j)attrs={x:x,y:y},this.add(attrs);for(mineNum=_k=1;numOfMines>=1?numOfMines>=_k:_k>=numOfMines;mineNum=numOfMines>=1?++_k:--_k)tile=this.randomSafeTile(),tile.model.isMine=!0;return this.tallyMines()},CollectTiles.prototype.loadGame=function(savedTiles){var tile,_i,_len;for(this.reset(),_i=0,_len=savedTiles.length;_len>_i;_i++)tile=savedTiles[_i],this.add(tile.model);return this},CollectTiles.prototype.reset=function(){return this.all=[],this},CollectTiles.prototype.clearNeighbors=function(tile){var adjacentTile,neighbor,shouldClearNeighbor,shouldClearNeighbors,_i,_len,_ref;if(shouldClearNeighbors=0===tile.model.adjacentMines&&tile.model.isMine===!1)for(_ref=tile.adjacentTiles,_i=0,_len=_ref.length;_len>_i;_i++)adjacentTile=_ref[_i],neighbor=this.get({x:tile.model.x+adjacentTile[0],y:tile.model.y+adjacentTile[1]}),shouldClearNeighbor=neighbor&&neighbor.model.isClear===!1&&neighbor.model.isMine===!1,shouldClearNeighbor&&neighbor.clear();return this},CollectTiles}()});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbGxlY3Rpb25zL3RpbGVzLmNvZmZlZSIsImNvbGxlY3Rpb25zL3RpbGVzLmpzIl0sIm5hbWVzIjpbIl9faGFzUHJvcCIsImhhc093blByb3BlcnR5IiwiX19leHRlbmRzIiwiY2hpbGQiLCJwYXJlbnQiLCJjdG9yIiwidGhpcyIsImNvbnN0cnVjdG9yIiwia2V5IiwiY2FsbCIsInByb3RvdHlwZSIsIl9fc3VwZXJfXyIsImFuZ3VsYXIiLCJtb2R1bGUiLCJmYWN0b3J5IiwiTW9kZWxUaWxlIiwiQ29sbGVjdFRpbGVzIiwid2lkdGhPclNhdmVkR2FtZSIsImhlaWdodCIsIm51bU9mTWluZXMiLCJNb2RlbCIsImNvbGxlY3Rpb24iLCJtb2RlbCIsIl9zdXBlciIsImFwcGx5IiwiYXJndW1lbnRzIiwiY2xlYXIiLCJjbGVhck5laWdoYm9ycyIsIkFycmF5IiwiaXNBcnJheSIsImxvYWRHYW1lIiwibmV3R2FtZSIsImFkZCIsInRpbGUiLCJhbGwiLCJwdXNoIiwiZ2V0IiwiYXR0cnMiLCJnZXRBbGwiLCJtYXRjaGVzIiwibnVtT2ZBdHRycyIsIm51bU9mTWF0Y2hlZEF0dHJzIiwidmFsIiwiX2kiLCJfaiIsIl9sZW4iLCJfbGVuMSIsIl9yZWYiLCJfcmVmMSIsImxlbmd0aCIsInRhbGx5TWluZXMiLCJhZGphY2VudFRpbGUiLCJuZWlnaGJvckF0dHJzIiwibmVpZ2hib3JNaW5lIiwibmVpZ2hib3JNaW5lcyIsIm5laWdoYm9yWCIsIm5laWdoYm9yWSIsImFkamFjZW50VGlsZXMiLCJ4IiwieSIsImlzTWluZSIsImFkamFjZW50TWluZXMiLCJyYW5kb21TYWZlVGlsZSIsImZpbmRBdHRycyIsInJhbmRvbUluZGV4Iiwic2FmZVRpbGVzIiwiaXNDbGVhciIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImF1dG9TZWxlY3QiLCJudW0iLCJzaXplWCIsInNpemVZIiwibWluZU51bSIsIl9rIiwicmVzZXQiLCJzYXZlZFRpbGVzIiwibmVpZ2hib3IiLCJzaG91bGRD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LGFBQUFOLFVBNkZBb0IsU0FBVyxTQUFDK0MsWUFDUixHQUFBNUMsTUFBQVUsR0FBQUUsSUFDQSxLQURBdkMsS0FBQ3NFLFFBQ0RqQyxHQUFBLEVBQUFFLEtBQUFnQyxXQUFBNUIsT0FBQUosS0FBQUYsR0FBQUEsS0NtQ0pWLEtBQU80QyxXQUFXbEMsSURsQ1ZyQyxLQUFDMEIsSUFBSUMsS0FBS1gsTUNxQ3BCLE9EcENNaEIsT0FqR0pVLGFBQUFOLFVBbUdBa0UsTUFBUSxXQ3VDVixNRHRDTXRFLE1BQUM0QixPQUNENUIsTUFyR0pVLGFBQUFOLFVBdUdBaUIsZUFBaUIsU0FBQ00sTUFDZCxHQUFBa0IsY0FBQTJCLFNBQUFDLG9CQUFBQyxxQkFBQXJDLEdBQUFFLEtBQUFFLElBQ0EsSUFEQWlDLHFCQUFtRCxJQUE1Qi9DLEtBQUtYLE1BQU11QyxlQUF1QjVCLEtBQUtYLE1BQU1zQyxVQUFVLEVBRTFFLElBQUFiLEtBQUFkLEtBQUF3QixjQUFBZCxHQUFBLEVBQUFFLEtBQUFFLEtBQUFFLE9BQUFKLEtBQUFGLEdBQUFBLEtDeUNOUSxhQUFlSixLQUFLSixJRHhDVm1DLFNBQVd4RSxLQUFDOEIsS0FDUnNCLEVBQUl6QixLQUFLWCxNQUFNb0MsRUFBSVAsYUFBYSxHQUNoQ1EsRUFBSTFCLEtBQUtYLE1BQU1xQyxFQUFJUixhQUFhLEtBR3BDNEIsb0JBQ0lELFVBQ0FBLFNBQVN4RCxNQUFNNEMsV0FBVyxHQUMxQlksU0FBU3hELE1BQU1zQyxVQUFVLEVBRzFCbUIscUJBQ0NELFNBQVNwRCxPQ3VDM0IsT0RyQ01wQixPQ3dDRFUiLCJmaWxlIjoiY29sbGVjdGlvbnMvdGlsZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyXG4ubW9kdWxlICdDb2xsZWN0VGlsZXMnLCBbXG4jIERlcGVuZGVuY2llc1xuICAgICdNb2RlbFRpbGUnLFxuXVxuXG4uZmFjdG9yeSAnQ29sbGVjdFRpbGVzJywgKFxuICAgIE1vZGVsVGlsZVxuKSAtPlxuICAgIGNsYXNzIENvbGxlY3RUaWxlc1xuICAgICAgICBjb25zdHJ1Y3RvciA6ICh3aWR0aE9yU2F2ZWRHYW1lLCBoZWlnaHQsIG51bU9mTWluZXMpIC0+XG5cbiAgICAgICAgICAgICMgRXh0ZW5kIE1vZGVsVGlsZSBzbyB0aGF0IGl0IGNhbiBleGVjdXRlIHNvbWUgY29sbGVjdGlvbiBsb2dpY1xuICAgICAgICAgICAgY29sbGVjdGlvbiA9IEBcbiAgICAgICAgICAgIEBtb2RlbCA9IGNsYXNzIE1vZGVsIGV4dGVuZHMgTW9kZWxUaWxlXG4gICAgICAgICAgICAgICAgY2xlYXI6IC0+XG4gICAgICAgICAgICAgICAgICAgIHN1cGVyKClcbiAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5jbGVhck5laWdoYm9ycyBAXG5cbiAgICAgICAgICAgICMgTG9hZCBvciBDcmVhdGUgbmV3IGdhbWVcbiAgICAgICAgICAgIGlmIEFycmF5LmlzQXJyYXkgd2lkdGhPclNhdmVkR2FtZVxuICAgICAgICAgICAgICAgIEBsb2FkR2FtZSB3aWR0aE9yU2F2ZWRHYW1lXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgQG5ld0dhbWUgd2lkdGhPclNhdmVkR2FtZSwgaGVpZ2h0LCBudW1PZk1pbmVzXG5cbiAgICAgICAgICAgIEBcblxuICAgICAgICBhZGQgOiAobW9kZWwpIC0+XG4gICAgICAgICAgICB0aWxlID0gbmV3IEBtb2RlbCBtb2RlbFxuICAgICAgICAgICAgQGFsbC5wdXNoIHRpbGVcbiAgICAgICAgICAgIHRpbGVcblxuICAgICAgICBnZXQgOiAoYXR0cnMpIC0+XG4gICAgICAgICAgICByZXR1cm4gQGdldEFsbChhdHRycylbMF1cblxuICAgICAgICBnZXRBbGwgOiAoYXR0cnMpIC0+XG4gICAgICAgICAgICBtYXRjaGVzID0gW11cbiAgICAgICAgICAgIGlmIGF0dHJzIGlzIHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIGZvciB0aWxlIGluIEBhbGxcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcy5wdXNoIHRpbGVcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBmb3IgdGlsZSBpbiBAYWxsXG4gICAgICAgICAgICAgICAgICAgIG51bU9mQXR0cnMgPSAwXG4gICAgICAgICAgICAgICAgICAgIG51bU9mTWF0Y2hlZEF0dHJzID0gMFxuICAgICAgICAgICAgICAgICAgICBmb3Iga2V5LCB2YWwgb2YgYXR0cnNcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bU9mQXR0cnMrK1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgdGlsZS5tb2RlbFtrZXldIGlzIHZhbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bU9mTWF0Y2hlZEF0dHJzKytcblxuICAgICAgICAgICAgICAgICAgICBpZiBudW1PZk1hdGNoZWRBdHRycyBpcyBudW1PZkF0dHJzXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVzLnB1c2ggdGlsZVxuXG4gICAgICAgICAgICByZXR1cm4gbWF0Y2hlc1xuXG4gICAgICAgIHRhbGx5TWluZXMgOiAoKSAtPlxuICAgICAgICAgICAgZm9yIHRpbGUgaW4gQGdldEFsbCgpXG4gICAgICAgICAgICAgICAgbmVpZ2hib3JNaW5lcyA9IDBcbiAgICAgICAgICAgICAgICBmb3IgYWRqYWNlbnRUaWxlIGluIHRpbGUuYWRqYWNlbnRUaWxlc1xuICAgICAgICAgICAgICAgICAgICBuZWlnaGJvclggPSB0aWxlLm1vZGVsLnggKyBhZGphY2VudFRpbGVbMF0gXG4gICAgICAgICAgICAgICAgICAgIG5laWdoYm9yWSA9IHRpbGUubW9kZWwueSArIGFkamFjZW50VGlsZVsxXVxuICAgICAgICAgICAgICAgICAgICBuZWlnaGJvckF0dHJzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNNaW5lICA6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIHggICAgICAgOiBuZWlnaGJvclhcbiAgICAgICAgICAgICAgICAgICAgICAgIHkgICAgICAgOiBuZWlnaGJvcllcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBuZWlnaGJvck1pbmUgPSB0aGlzLmdldChuZWlnaGJvckF0dHJzKVxuICAgICAgICAgICAgICAgICAgICBpZiBuZWlnaGJvck1pbmUgaXNudCB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5laWdoYm9yTWluZXMrK1xuICAgICAgICAgICAgICAgIHRpbGUubW9kZWwuYWRqYWNlbnRNaW5lcyA9IG5laWdoYm9yTWluZXNcblxuICAgICAgICAgICAgQFxuXG4gICAgICAgIHJhbmRvbVNhZmVUaWxlIDogKCkgLT5cbiAgICAgICAgICAgIGZpbmRBdHRycyA9XG4gICAgICAgICAgICAgICAgaXNDbGVhciA6IGZhbHNlXG4gICAgICAgICAgICAgICAgaXNNaW5lICA6IGZhbHNlXG5cbiAgICAgICAgICAgIHNhZmVUaWxlcyA9IEBnZXRBbGwgZmluZEF0dHJzXG4gICAgICAgICAgICByYW5kb21JbmRleCA9IE1hdGguZmxvb3IgTWF0aC5yYW5kb20oKSAqIHNhZmVUaWxlcy5sZW5ndGhcbiAgICAgICAgICAgIHJldHVybiBzYWZlVGlsZXNbIHJhbmRvbUluZGV4IF1cblxuICAgICAgICBhdXRvU2VsZWN0IDogKG51bSkgLT5cbiAgICAgICAgICAgIHdoaWxlIG51bS0tXG4gICAgICAgICAgICAgICAgQHJhbmRvbVNhZmVUaWxlKCkuY2xlYXIoKVxuXG4gICAgICAgICAgICBAYWxsXG5cbiAgICAgICAgbmV3R2FtZSA6IChzaXplWCwgc2l6ZVksIG51bU9mTWluZXMpIC0+XG4gICAgICAgICAgICBAcmVzZXQoKVxuICAgICAgICAgICAgZm9yIHkgaW4gWzAuLnNpemVZIC0gMV1cbiAgICAgICAgICAgICAgICBmb3IgeCBpbiBbMC4uc2l6ZVggLSAxXVxuICAgICAgICAgICAgICAgICAgICBhdHRycyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHggICA6IHhcbiAgICAgICAgICAgICAgICAgICAgICAgIHkgICA6IHlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBAYWRkIGF0dHJzXG5cbiAgICAgICAgICAgIGZvciBtaW5lTnVtIGluIFsxLi5udW1PZk1pbmVzXVxuICAgICAgICAgICAgICAgIHRpbGUgPSBAcmFuZG9tU2FmZVRpbGUoKVxuICAgICAgICAgICAgICAgIHRpbGUubW9kZWwuaXNNaW5lID0gdHJ1ZVxuXG4gICAgICAgICAgICBAdGFsbHlNaW5lcygpXG5cbiAgICAgICAgbG9hZEdhbWUgOiAoc2F2ZWRUaWxlcykgLT5cbiAgICAgICAgICAgIEByZXNldCgpXG4gICAgICAgICAgICBmb3IgdGlsZSBpbiBzYXZlZFRpbGVzXG4gICAgICAgICAgICAgICAgQGFkZCB0aWxlLm1vZGVsXG4gICAgICAgICAgICBAXG5cbiAgICAgICAgcmVzZXQgOiAtPlxuICAgICAgICAgICAgQGFsbCA9IFtdXG4gICAgICAgICAgICBAXG5cbiAgICAgICAgY2xlYXJOZWlnaGJvcnMgOiAodGlsZSkgLT5cbiAgICAgICAgICAgIHNob3VsZENsZWFyTmVpZ2hib3JzID0gdGlsZS5tb2RlbC5hZGphY2VudE1pbmVzIGlzIDAgYW5kIHRpbGUubW9kZWwuaXNNaW5lIGlzIGZhbHNlXG4gICAgICAgICAgICBpZiBzaG91bGRDbGVhck5laWdoYm9yc1xuICAgICAgICAgICAgICAgIGZvciBhZGphY2VudFRpbGUgaW4gdGlsZS5hZGphY2VudFRpbGVzXG4gICAgICAgICAgICAgICAgICAgIG5laWdoYm9yID0gQGdldChcbiAgICAgICAgICAgICAgICAgICAgICAgIHggOiB0aWxlLm1vZGVsLnggKyBhZGphY2VudFRpbGVbMF1cbiAgICAgICAgICAgICAgICAgICAgICAgIHkgOiB0aWxlLm1vZGVsLnkgKyBhZGphY2VudFRpbGVbMV1cbiAgICAgICAgICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICAgICAgICAgIHNob3VsZENsZWFyTmVpZ2hib3IgPSAoXG4gICAgICAgICAgICAgICAgICAgICAgICBuZWlnaGJvciBhbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIG5laWdoYm9yLm1vZGVsLmlzQ2xlYXIgaXMgZmFsc2UgYW5kXG4gICAgICAgICAgICAgICAgICAgICAgICBuZWlnaGJvci5tb2RlbC5pc01pbmUgaXMgZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIHNob3VsZENsZWFyTmVpZ2hib3JcbiAgICAgICAgICAgICAgICAgICAgICAgIG5laWdoYm9yLmNsZWFyKClcblxuICAgICAgICAgICAgQCIsbnVsbF0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9